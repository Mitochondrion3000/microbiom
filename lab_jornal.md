–¥–∞–Ω–Ω—ã–µ —è –≤–∑—è–ª –æ—Ç—Å—é–¥–∞ https://trace.ncbi.nlm.nih.gov/Traces/?view=run_browser&acc=SRR29762644&display=data-access
![image](https://github.com/user-attachments/assets/ffba42f3-7a9b-4f1a-a07d-b9c49f4d6d8b)

 
conda activate sra_env
fastq-dump --split-files --gzip /home/ivan/Desktop/itmo/microbiom/SRR29762644 - —Ç–∞–∫ –º—ã –ø–æ–ª—É—á–∏–ª–∏ fastq —Ñ–∞–π–ª—ã

–º–µ–Ω—è –µ—â–µ –æ—á–µ–Ω—å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –º–æ–º–µ–Ω—Ç —á—Ç–æ –∞–Ω–∞–ª–∏–∑ –∫–∞–ª–∞ –º–æ–∂–µ—Ç –≤–µ—Å–∏—Ç—å –∫–∞–∫ –∏ 200–º–± —Ç–∞–∫ –∏ 7 –≥–±, –ø–æ—á–µ–º—É —Ç–∞–∫, –æ—Ç–∫—É–¥–∞ —Ç–∫–∞–∫–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –±–µ—Ä–µ—Ç—Å—è 

–æ—Å—Ç–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫—Ä–∞–∫–µ–Ω–∞

–¥–ª—è –Ω–∞—á–∞–ª–∞ —Ö–æ—Ä–æ—à–æ –±—ã —Å–∫–∞—á–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, —è –≤–∑—è–ª —ç—Ç—É https://genome-idx.s3.amazonaws.com/kraken/k2_standard_08gb_20250402.tar.gz
–∞ –ø–æ—Ç–æ–º –Ω—É–∂–Ω–æ —Ä–∞—Å–ø–æ–∫–æ–≤–∞—Ç—å –∞—Ä—Ö–∏–≤, –Ω–∞–≤—Ä–µ–Ω–æ–µ —Ö–æ—Ä–æ—à–æ –±—ã —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –≤ –æ—Ç–ª–µ—å–Ω—É—é –ø–∞–ø–∫—É, –Ω–æ —è —Ä–∞—Å–ø–∞–∫–æ–≤–∞–ª –≤ —Ä–∞–±–æ—á—É—é, —ç—Ç–æ –±—ã–ª–æ –æ—à–∏–±–∫–æ–π –∏–±–æ —Ç–∞–º –ø–æ–ª—É—á–∏–ª–æ—Å—å –º–Ω–æ–≥–æ —Ñ–∞–π–ª–æ–≤
















Kraken2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ñ–∞–π–ª–æ–≤ —Å git –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏—ã–µ —Ñ–∞–π–ª—ã –≤ path —É –º–µ–Ω—è –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –ø–æ—ç—Ç–æ–º—É –ø–æ—Å—Ç–∞–≤–∏–ª –∫—Ä–∞–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ –∫–æ–Ω–¥—É –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ –≤—Å–µ –∑–∞—Ä–∞–±–æ—Ç–∞–ª–æ 


–ó–∞–ø—É—Å–∫ —Å–∞–º–æ–≥–æ –∫—Ä–∞–∫–µ–Ω–∞

 kraken2 --confidence 0.1 --paired --threads 60 --report report.txt --use-names --db /home/ivan/Desktop/itmo/microbiom/ /home/ivan/Desktop/itmo/microbiom/SRR29762644_1.fastq.gz /home/ivan/Desktop/itmo/microbiom/SRR29762644_2.fastq.gz

### –ß—Ç–æ –º—ã –ø–æ—É–ª—á–∞–µ–º –Ω–∞ –≤—ã—Ö–æ–¥–µ

1. **`report.txt`** ‚Äî *—Ç–∞–∫—Å–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –æ—Ç—á—ë—Ç –≤ –≤–∏–¥–µ —Ç–∞–±–ª–∏—Ü—ã*, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π:

   * –î–æ–ª—é –ø—Ä–æ—á—Ç–µ–Ω–∏–π, –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫ –¥–∞–Ω–Ω–æ–º—É —Ç–∞–∫—Å–æ–Ω—É
   * –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—á—Ç–µ–Ω–∏–π
   * –¢–∞–∫—Å–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —É—Ä–æ–≤–µ–Ω—å (D = domain, P = phylum, ... S = species)
   * –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–∞–∫—Å–æ–Ω–∞

   –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –≤ `report.txt`:

   ```
   13.21  105432  105432  U  0  unclassified
   86.79  692345  692345  R  1  root
   ...
   ```

2. **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª (–∏–ª–∏ –≤ `--output` —Ñ–∞–π–ª, –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω)** ‚Äî –ø–æ—Å—Ç—Ä–æ—á–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—á—Ç–µ–Ω–∏—è:

üìå –ü–æ–¥—Ä–æ–±–Ω—ã–π —Ä–∞–∑–±–æ—Ä

1. –°—Ç—Ä–æ–∫–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:

–ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –≤ –Ω–∞—á–∞–ª–µ ‚Äî —ç—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ –æ–¥–Ω–æ–º—É –ø—Ä–æ—á—Ç–µ–Ω–∏—é. –í–æ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

C|U   <read_id>   <taxon name (taxid)>   <read lengths>   <k-mer hits>

–ü—Ä–∏–º–µ—Ä—ã:

‚úÖ –ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–æ—á—Ç–µ–Ω–∏–µ:

C	SRR29762644.1768750	Cutibacterium acnes (taxid 1747)	151|151	1747:2 0:37 1747:3 0:6 31957:3 1747:4 0:20 1747:4 0:38 |:| 0:6 2:3 0:56 1747:4 0:20 1747:4 31957:3 0:6 1747:3 0:12

üîπ C ‚Äî –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æüîπ ID –ø—Ä–æ—á—Ç–µ–Ω–∏—è: SRR29762644.1768750üîπ –†–µ–∑—É–ª—å—Ç–∞—Ç: –æ—Ç–Ω–µ—Å–µ–Ω–æ –∫ Cutibacterium acnes (—Ç–∞–∫—Å–æ–Ω ID 1747)üîπ 151|151 ‚Äî –¥–ª–∏–Ω–∞ –∫–∞–∂–¥–æ–≥–æ —Ä–∏–¥–∞ –≤ –ø–∞—Ä–µüîπ k-mer –º–µ—Ç–∫–∏:

1747:2 –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ 2 k-–º–µ—Ä–∞ –±—ã–ª–∏ –Ω–∞–π–¥–µ–Ω—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–ª–∏—Å—å —Å —Ç–∞–∫—Å–æ–Ω–æ–º 1747

|:| —Ä–∞–∑–¥–µ–ª—è–µ—Ç forward –∏ reverse read

–ò —Ç–∞–∫ –¥–∞–ª–µ–µ‚Ä¶

‚ùå –ù–µ–∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–æ—á—Ç–µ–Ω–∏–µ:

U	SRR29762644.1768751	unclassified (taxid 0)	151|151	0:3 1747:4 0:44 1747:3 0:63 |:| 0:2 1747:1 0:9 1747:1 0:8 1747:3 0:19 1747:1 0:23 1747:8 0:42

üîπ U ‚Äî unclassifiedüîπ –ï—Å—Ç—å —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å —Ç–∞–∫—Å–æ–Ω–æ–º 1747, –Ω–æ –æ–Ω–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–≤–µ—Ä–µ–Ω–Ω—ã–µ (–∏–ª–∏ –Ω–µ –ø—Ä–µ–æ–¥–æ–ª–µ–ª–∏ –ø–æ—Ä–æ–≥ --confidence 0.1)üîπ –ü–æ—ç—Ç–æ–º—É –ø—Ä–æ—á—Ç–µ–Ω–∏–µ –Ω–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ
> ‚ö†Ô∏è –ï—Å–ª–∏ –≤—ã **–Ω–µ —É–∫–∞–∑–∞–ª–∏ `--output <file>`**, —Ç–æ —ç—Ç–∏ —Å—Ç—Ä–æ–∫–∏ –ø–æ—è–≤—è—Ç—Å—è –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –∞ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è.

---












‚Ä¢ –ò—Å—Ö–æ–¥–Ω–æ–π –∫–æ–¥ —Å GitHub

$ git clone https://github.com/DerrickWood/kraken2.git
$ cd kraken2
$ ./install_kraken2.sh ~/Desktop/itmo/microbiom/kraken2
$ nano ~/.bashrc
–≤–æ—Ç —Ç–∞–∫—É—é –∫–æ–º–∞–Ω–¥—É –≤—ã–ø–æ–ª—è–µ–º
–ø–æ—Ç–æ–º –≤–æ –≤—Ä–µ–º—è —É—Å—Ç–≤–Ω–æ–≤–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Å–∞–º–∞ –≤—ã–¥–∞–ª–∞ –ø—É—Ç–∏ –∫ –∏—Å–ø–æ–ª—è–µ–º—ã–º —Ñ–∞–π–ª–∞–º –∏ –≤ –∫–æ–Ω–µ—Ü .bashrc —è –¥–æ–±–∞–≤–∏–ª 

export PATH="$PATH:/home/ivan/Desktop/itmo/microbiom/kraken2/kraken2"
export PATH="$PATH:/home/ivan/Desktop/itmo/microbiom/kraken2/kraken2-build"
export PATH="$PATH:/home/ivan/Desktop/itmo/microbiom/kraken2/kraken2-inspect" ---- —Å —ç—Ç–∏–º —ç—Ç–∞–ø–æ–º —á—Ç–æ-—Ç–æ –Ω–µ —Ç–æ 

$ exec bash - –ø—Ä–∏–º–µ–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ source ~/.bashrc)
–∏ –µ—â–µ –≤—Å–µ–º —ç—Ç–∏ —Ñ–∞–π–ª–∞–º –Ω—É–∂–Ω–æ –¥–∞—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∏—Å–ø–æ–ª–µ–Ω–∏–µ 

–ø—Ä–æ–≤–µ—Ä—è–µ–º

which kraken2
which kraken2-build
which kraken2-inspect ------------ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç 

‚Ä¢ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–ª—è conda (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏–∑-–∑–∞ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã)

$ conda create -n kraken2 python=3.9
$ conda activate kraken2
$ conda install -c bioconda kraken2

Kraken2. –†–∞–±–æ—Ç–∞

‚Ä¢ kraken2 --minimum-hit-groups 3 --confidence 0.5 --paired --
threads 60 --report report1gr_st_r.txt --use-names --db
/mnt/disk1/db/k2_db fed1gr_S1_L001_R1_001.fastq
fed1gr_S1_L001_R2_001.fastq > /dev/null

--minimum-hit-groups 3 –∏ --confidence 0.5 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –ª–æ–∂–Ω–æ–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö
—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
--report –≤—ã–¥–∞–µ—Ç –æ—Ç—á–µ—Ç –æ —á–∏—Å–ª–µ –ø—Ä–æ—á—Ç–µ–Ω–∏–π, –æ—Ç–Ω–æ—Å—è—â–∏—Ö—Å—è –∫ —Ç–∞–∫—Å–æ–Ω–∞–º
--classified-out –≤—ã–¥–∞–µ—Ç –ø—Ä–æ—á—Ç–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞–Ω—ã
